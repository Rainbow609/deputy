proxies:
# clashMetaé…ç½®å‚è€ƒå¯ä»¥çœ‹çœ‹è¿™ä¸ªwiki
# https://docs.metacubex.one/
# https://clash-meta.wiki

# å®˜æ–¹clashé…ç½®(çº¯è‹±æ–‡)
# https://github.com/Dreamacro/clash/wiki/Configuration#introduction

#é¢„è®¾
p: &p
  type: http
  interval: 1800
  health-check:
    enable: true
    url: https://cp.cloudflare.com/generate_204
    interval: 300


# ä»£ç†æä¾›(è®¢é˜…)ç»„
proxy-providers:
  ç¾¤ä¸»_æ˜Ÿé“¾äº‘:
    <<: *p
    url: "https://www.nite07.com/sub/s/i2tZBl"
    path: ./proxy_providers/ç¾¤ä¸»_æ˜Ÿé“¾äº‘.yaml

  ç¾¤ä¸»_EF:
    <<: *p
    url: "https://www.nite07.com/sub/s/kf0qMD"
    path: ./proxy_providers/ç¾¤ä¸»_EF.yaml

  ç¾¤ä¸»_å¿«æ¸¸æˆ:
    <<: *p
    url: "https://www.nite07.com/sub/s/A6SkOd"
    path: ./proxy_providers/ç¾¤ä¸»_å¿«æ¸¸æˆ.yaml

  ç¾¤ä¸»_ä¸‰åˆ†:
    <<: *p
    url: "https://www.nite07.com/sub/s/9p329U"
    path: ./proxy_providers/ç¾¤ä¸»_ä¸‰åˆ†.yaml

  ç¾¤ä¸»_wget:
    <<: *p
    url: "https://www.nite07.com/sub/s/U5VXPD"
    path: ./proxy_providers/ç¾¤ä¸»_wget.yaml
    # wget.moe

  ç¾¤ä¸»_å…»çŒªåœº:
    <<: *p
    url: "https://www.nite07.com/sub/s/3byz1Y"
    path: ./proxy_providers/ç¾¤ä¸»_å…»çŒªåœº.yaml

  å°å†°_EF:
    <<: *p
    url: "https://www.nite07.com/sub/s/ZIiqkz"
    path: ./proxy_providers/å°å†°_EF.yaml

  å°å†°_ç™½å«–:
    <<: *p
    url: "https://www.nite07.com/sub/s/lOfPFe"
    path: ./proxy_providers/å°å†°_ç™½å«–.yaml

  ç«é”…_ä¸‰åˆ†:
    <<: *p
    url: "https://www.nite07.com/sub/s/Wg5ZyU"
    path: ./proxy_providers/ç«é”…_ä¸‰åˆ†.yaml

  è¾¾è¾¾_EF:
    <<: *p
    url: "https://www.nite07.com/sub/s/gH7qDB"
    path: ./proxy_providers/è¾¾è¾¾_EF.yaml

  å…±äº«_ermaozi:
  # ä¾†è‡ª https://github.com/ermaozi/get_subscribe
    <<: *p
    url: "https://www.nite07.com/sub/s/1X53si"
    path: ./proxies/å…±äº«_ermaozi.yaml


use: &use
  include-all-providers: true

urltest: &urltest
  type: url-test
  # url: "http://www.gstatic.com/generate_204"
  url: "https://www.apple.com/library/test/success.html"  # æ›¿æ¢æˆè‹¹æœçš„æµ‹é€Ÿ
  interval: 180
  tolerance: 100
  <<: *use

fallback: &fallback
  type: fallback
  # url: "http://www.gstatic.com/generate_204"
  url: "https://www.apple.com/library/test/success.html"  # æ›¿æ¢æˆè‹¹æœçš„æµ‹é€Ÿ
  interval: 180
  tolerance: 100
  <<: *use

select: &select
  type: select
  <<: *use

lobalance: &lobalance
  type: load-balance
  url: "https://www.apple.com/library/test/success.html"
  interval: 300
  strategy: consistent-hashing
  <<: *use
  # strategy:
  #  consistent-hashing åŒä¸€ä¸ªåŸŸåä¸‹ä¼šæŒç»­ä½¿ç”¨åŒä¸€ä¸ªip, é»˜è®¤é€‰æ‹©è¯¥é¡¹ï¼Œé˜²æ­¢é¢‘ç¹è·³ipè¢«ç½‘ç«™ban
  #  round-robin æ¯è®¿é—®ä¸€ä¸ªé“¾æ¥ï¼Œé¡ºåºæ›´æ¢èŠ‚ç‚¹è®¿é—®

# ä»£ç†ç»„
proxy-groups:
  - name: proxy
    type: select
    proxies:
      - HK urltest
      - HK fallback
      - HK select
      - HK lobalance
      - å°æ¹¾
      - æ—¥æœ¬
      - æ–°åŠ å¡
      - ç¾å›½
      - å…¶å®ƒåœ°åŒº
      - å…¨éƒ¨èŠ‚ç‚¹
      - ç›´è¿

# æŒ‰ç…§åŒºåŸŸåˆ’å®šç­–ç•¥ç»„
  - {name: HK urltest, <<: *urltest, filter: "(?i)æ¸¯|hk|hongkong|hong kong"}
  - {name: HK fallback, <<: *fallback, filter: "(?i)æ¸¯|hk|hongkong|hong kong"}
  - {name: HK select, <<: *select, filter: "(?i)æ¸¯|hk|hongkong|hong kong"}
  - {name: HK lobalance, <<: *lobalance, filter: "(?i)æ¸¯|hk|hongkong|hong kong"}

  - {name: å°æ¹¾, << *urltest , <<: *use, filter: "(?i)å°|tw|taiwan"}
  - {name: æ—¥æœ¬, << *urltest , <<: *use, filter: "(?i)æ—¥|jp|japan"}
  - {name: ç¾å›½, << *urltest , <<: *use, filter: "(?i)ç¾|us|unitedstates|united states"}
  - {name: æ–°åŠ å¡, << *urltest , <<: *use, filter: "(?i)(æ–°|sg|singapore)"}
  - {name: å…¶å®ƒåœ°åŒº, type: select , <<: *use, filter: "(?i)^(?!.*(?:ğŸ‡­ğŸ‡°|ğŸ‡¯ğŸ‡µ|ğŸ‡ºğŸ‡¸|ğŸ‡¸ğŸ‡¬|ğŸ‡¨ğŸ‡³|æ¸¯|hk|hongkong|å°|tw|taiwan|æ—¥|jp|japan|æ–°|sg|singapore|ç¾|us|unitedstates)).*"}
  - {name: å…¨éƒ¨èŠ‚ç‚¹, type: select , <<: *use}
  - {name: å‰©ä½™æµé‡, type: select, <<: *use, filter: "å‰©ä½™æµé‡|è·ç¦»ä¸‹æ¬¡é‡ç½®å‰©ä½™|å¥—é¤åˆ°æœŸ|å®˜ç½‘"}
  
  - name: ç›´è¿
    type: select
    proxies:
      - DIRECT
      

# åˆ†æµè§„åˆ™æä¾›(è®¢é˜…)ç»„
rule-providers:
# ç§‹é£å¹¿å‘Šè§„åˆ™Clashç‰ˆæœ¬
# Githubï¼šhttps://github.com/TG-Twilight/AWAvenue-Ads-Rule
# æ­¤ä¸ºåŸŸåæ‹¦æˆªè§„åˆ™ï¼Œè¯·æ ¹æ®å®é™…æƒ…å†µï¼Œè‡ªè¡Œè®¾ç½®ä¸ºREJECT/å¹¿å‘Šæ‹¦æˆªä¹‹ç±»çš„åˆ†ç»„ã€‚
  AWAvenue:
    type: http
    behavior: domain
    format: yaml
    path: ./rule_providers/AWAvenue-Ads-Rule-Clash.yaml
    url: "https://raw.githubusercontent.com/TG-Twilight/AWAvenue-Ads-Rule/main/Filters/AWAvenue-Ads-Rule-Clash.yaml"
    interval: 60480

  direct:
    # ç›´è¿åŸŸååˆ—è¡¨
    <<: *rule_update
    behavior: domain
    url: "https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/direct.txt"
    path: ./rule_providers/direct.yaml

  private:
    # ç§æœ‰ç½‘ç»œä¸“ç”¨åŸŸååˆ—è¡¨
    <<: *rule_update
    behavior: domain
    url: "https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/private.txt"
    path: ./rule_providers/private.yaml

  cncidr:
    # ä¸­å›½å¤§é™† IP åœ°å€åˆ—è¡¨
    <<: *rule_update
    behavior: ipcidr
    url: "https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/cncidr.txt"
    path: ./rule_providers/cncidr.yaml

  lancidr:
    # å±€åŸŸç½‘ IP åŠä¿ç•™ IP åœ°å€åˆ—è¡¨
    <<: *rule_update
    behavior: ipcidr
    url: "https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/lancidr.txt"
    path: ./rule_providers/lancidr.yaml

  applications:
    # éœ€è¦ç›´è¿çš„å¸¸è§è½¯ä»¶åˆ—è¡¨
    <<: *rule_update
    behavior: classical
    url: "https://cdn.jsdelivr.net/gh/Loyalsoldier/clash-rules@release/applications.txt"
    path: ./rule_providers/applications.yaml

# åˆ†æµè§„åˆ™
rules:
  - AND,(AND,(DST-PORT,443),(NETWORK,UDP)),(NOT,((GEOSITE,cn))),REJECT-DROP # ç¦ç”¨quic(ä¸åŒ…æ‹¬å›½å†…)
  - RULE-SET,AWAvenue,REJECT-DROP

  - RULE-SET,lancidr,DIRECT
  - RULE-SET,applications,DIRECT
  - RULE-SET,cncidr,DIRECT
  - RULE-SET,direct,DIRECT
  - RULE-SET,private,DIRECT
  - GEOIP,private,DIRECT

  - GEOSITE,cn,DIRECT
  - GEOIP,CN,DIRECT
  - MATCH,proxy

